<?xml version = "1.0"?>
<robot name = "caster" xmlns:xacro = "http://www.ros.org/wiki/xacro" description = "iqr caster">
  <xacro:property name = "PI" value = "3.1415926535897931" />

  <xacro:macro name="default_inertial" params="mass">
    <inertial>
      <mass value="${mass}" />
    <inertia ixx="1.0" ixy="0.0" ixz="0.0"
             iyy="1.0" iyz="0.0"
             izz="1.0" />
    </inertial>
  </xacro:macro>
  <!--define support_wheel unit-->
  <xacro:macro name = "support_wheel" params = "parent location *origin">
    <link name = "${location}_support_wheel_link">
      <visual>
        <origin xyz = "0 0 0" rpy = "0 0 0"/>
        <geometry>
          <mesh filename = "package://caster_description/mesh/support_wheel.STL" />
        </geometry>
        <material name = "black">
          <color rgba = "0.3 0.3 0.3 1.0" />
        </material>
      </visual>
      <xacro:default_inertial mass="0.1"/>
    </link>

    <joint name = "${location}_support_wheel_joint" type = "continuous">
      <xacro:insert_block name = "origin" />
      <parent link = "${parent}"/>
      <child link = "${location}_support_wheel_link"/>
      <axis xyz="0 0 1"/>
    </joint>
  </xacro:macro>
  <!--define drive_wheel unit-->
  <xacro:macro name = "drive_wheel" params = "parent location *origin">
    <link name = "${location}_drive_wheel_link">
      <visual>
        <origin xyz = "0 0 0" rpy = "0 0 0"/>
        <geometry>
          <mesh filename = "package://caster_description/mesh/drive_wheel.STL" />
        </geometry>
        <material name = "black">
          <color rgba = "0.30 0.30 0.30 1" />
        </material>
      </visual>
      <xacro:default_inertial mass="0.1"/>
    </link>

    <joint name = "${location}_drive_wheel_joint" type = "continuous">
      <xacro:insert_block name = "origin" />
      <parent link = "${parent}"/>
      <child link = "${location}_drive_wheel_link"/>
      <axis xyz="0 1 0"/>
    </joint>
  </xacro:macro>
  <!--define ULT unit-->
  <xacro:macro name = "ultrasound_detector" params = "parent location *origin">
    <link name = "${location}_ultrasound_detector_link">
      <visual>
        <origin xyz = "0 0 0" rpy = "0 ${PI/2} 0"/>
        <geometry>
          <cylinder length = "0.01" radius = "0.01" />
        </geometry>
        <material name = "black">
          <color rgba = "0.3 0.3 0.3 1.0" />
        </material>
      </visual>
      <xacro:default_inertial mass="0.1"/>
    </link>

    <joint name = "${location}_ultrasound_detector_joint" type = "fixed">
      <xacro:insert_block name = "origin" />
      <parent link = "${parent}"/>
      <child link = "${location}_ultrasound_detector_link"/>
    </joint>
  </xacro:macro>
  <!--define caster unit-->
  <!--caster_base_link-->
  <xacro:macro name = "caster">
    <link name = "base_link">
      <visual>
        <origin xyz = "0 0 0" rpy = "0 0 0"/>
        <geometry>
          <mesh filename = "package://caster_description/mesh/caster_base.STL" />
        </geometry>
        <material name = "">
          <color rgba = "0.98 1.0 0.94 1.0" />
        </material>
      </visual>
      <xacro:default_inertial mass="10"/>
    </link>

    <link name = "footprint">
      <origin xyz = "0 0 0" rpy = "0 0 0"/>
      <xacro:default_inertial mass="0.0001"/>
    </link>

    <joint name = "base_footprint_joint" type = "fixed">
      <origin xyz = "0 0 -0.030" rpy = "0 0 0"/>
      <parent link = "base_link"/>
      <child link = "footprint"/>
    </joint>
    <!--LaserScan unit-->
    <link name = "laser_scan_link">
      <origin xyz = "0 0 0" rpy = "0 0 0"/>
      <xacro:default_inertial mass="0.0001"/>
    </link>

    <joint name = "laser_scan_joint" type = "fixed">
      <origin xyz = "0.2301 0 0.147" rpy = "0 0 0"/>
      <parent link = "base_link"/>
      <child link = "laser_scan_link"/>
    </joint>
    <!--create left_drive_wheel-->
    <xacro:drive_wheel parent = "base_link" location = "left">
      <origin xyz = "0 0.2012 0.045" rpy = "0 0 0" />
    </xacro:drive_wheel>
    <!--create right_drive_wheel-->
    <xacro:drive_wheel parent = "base_link" location = "right">
      <origin xyz = "0 -0.2012 0.045" rpy = "0 0 ${PI}" />
    </xacro:drive_wheel>
    <!--create left_front_support_wheel-->
    <xacro:support_wheel parent = "base_link" location = "left_front">
      <origin xyz = "0.185 0.150 0.037" rpy = "0 0 0" />
    </xacro:support_wheel>
    <!--create right_front_support_wheel-->
    <xacro:support_wheel parent = "base_link" location = "right_front">
      <origin xyz = "0.185 -0.150 0.037" rpy = "0 0 0" />
    </xacro:support_wheel>
    <!--create left_back_support_wheel-->
    <xacro:support_wheel parent = "base_link" location = "left_back">
      <origin xyz = "-0.185 0.150 0.037" rpy = "0 0 0" />
    </xacro:support_wheel>
    <!--create right_back_support_wheel-->
    <xacro:support_wheel parent = "base_link" location = "right_back">
      <origin xyz = "-0.185 -0.150 0.037" rpy = "0 0 0" />
    </xacro:support_wheel>
    <!--define left_front ULT-->
    <xacro:ultrasound_detector parent = "base_link" location = "left_front">
      <origin xyz = "0.25 0.075 0.07" rpy = "0 0 0" />
    </xacro:ultrasound_detector>
    <!--define right_front ULT-->
    <xacro:ultrasound_detector parent = "base_link" location = "right_front">
      <origin xyz = "0.25 -0.075 0.07" rpy = "0 0 0" />
    </xacro:ultrasound_detector>
    <!--define left_back ULT-->
    <xacro:ultrasound_detector parent = "base_link" location = "left_back">
      <origin xyz = "-0.255 0.055 0.205" rpy = "0 0 ${PI}" />
    </xacro:ultrasound_detector>
    <!--define right_back ULT-->
    <xacro:ultrasound_detector parent = "base_link" location = "right_back">
      <origin xyz = "-0.255 -0.055 0.205" rpy = "0 0 ${PI}" />
    </xacro:ultrasound_detector>
  </xacro:macro>
</robot>